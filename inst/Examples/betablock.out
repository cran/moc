
R : Copyright 2003, The R Foundation for Statistical Computing
Version 1.8.1  (2003-11-21), ISBN 3-900051-00-3

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> invisible(options(echo = TRUE))
> bbloc <- read.table("Beta.dat",header=TRUE,skip=1)
> library(moc)


Package: moc
Version: 0.8-4
Date: 2004-02-02
Title: GENERAL NONLINEAR MIXTURES OF CURVES
Author: Bernard Boulerice <Bernard.Boulerice@umontreal.ca>
Maintainer: Bernard Boulerice <Bernard.Boulerice@umontreal.ca>
Depends:
Description: Fits a variety of mixtures models for multivariate
        observations with user-defined distributions and profiles.
License: GPL (version 2 or later, see the included file GPL)
Built: R 1.8.1; ; 2004-02-23 20:29:20; unix



   Supplementary utility functions to help combine MOC models can be found in
 /usr/share/R/library/moc/Utils/combine.moc.R 
   See the file for simple documentation. 
   You must source that file to use those functions.

> 
> # Random slope effect for beta blockers as in McLachlan & Peel pp. 165-166
> 
> binom <- function(x,prob,sh=1,size){dbinom(x,size,prob)}
> 
> gmu3 <-list(
+  Group1 = function (p) {cbind(1/(1 + exp(-p[2])), 1/(1 + exp(-p[2] - p[1])))},
+  Group2 = function (p) {cbind(1/(1 + exp(-p[3])), 1/(1 + exp(-p[3] - p[1])))},
+  Group3 = function (p) {cbind(1/(1 + exp(-p[4])), 1/(1 + exp(-p[4] - p[1])))})
> 
> gext3 <- list(
+  Group1 = function(p) cbind(bbloc[,3],bbloc[,5]),
+  Group2 = function(p) cbind(bbloc[,3],bbloc[,5]),
+  Group3 = function(p) cbind(bbloc[,3],bbloc[,5]))
> 
> bin.fitted <- list(
+  Group1 = function(p) (gmu3[[1]](p)%x%rep(1,22))*gext3[[1]](p),
+  Group2 = function(p) (gmu3[[2]](p)%x%rep(1,22))*gext3[[2]](p),
+  Group3 = function(p) (gmu3[[3]](p)%x%rep(1,22))*gext3[[3]](p))
>  
> 
> bbloc.moc3 <-  moc(bbloc[,c(2,4)],density=binom,group=3,gmu=gmu3,gextra=gext3,
+ expected=bin.fitted,pgmu=c(-0.25,-1.61,-2.25,-2.8),pgmix=c(0,0))
iteration = 0
Step:
[1] 0 0 0 0 0 0
Parameter:
[1] -0.25 -1.61 -2.25 -2.80  0.00  0.00
Function Value
[1] 160.7650
Gradient:
[1] 11.482935  5.623305  5.292078  6.167077 -3.259090  1.716501

iteration = 1
Step:
[1] -0.019689382 -0.009642082 -0.009074139 -0.010574468  0.005588246
[6] -0.002943223
Parameter:
[1] -0.269689382 -1.619642082 -2.259074139 -2.810574468  0.005588246
[6] -0.002943223
Function Value
[1] 160.6401
Gradient:
[1] -6.746589  0.712603 -9.026666  2.490753 -3.015237  1.747927

iteration = 2
Step:
[1]  0.004181553 -0.001554107  0.007233682 -0.003237187  0.003234319
[6] -0.001846812
Parameter:
[1] -0.265507829 -1.621196190 -2.251840457 -2.813811655  0.008822564
[6] -0.004790035
Function Value
[1] 160.5634
Gradient:
[1] -1.96449078 -0.04594509 -1.22673667  2.23108913 -3.05269625  1.73204841

iteration = 3
Step:
[1]  0.002251292 -0.001553891  0.003068785 -0.006297358  0.007172065
[6] -0.004043823
Parameter:
[1] -0.263256537 -1.622750081 -2.248771673 -2.820109013  0.015994629
[6] -0.008833858
Function Value
[1] 160.5236
Gradient:
[1] -0.1332124 -0.6483506  2.3561037  1.2327975 -3.0420407  1.7085065

iteration = 4
Step:
[1]  0.004216824 -0.001961022  0.001585751 -0.013535293  0.019028044
[6] -0.010708989
Parameter:
[1] -0.25903971 -1.62471110 -2.24718592 -2.83364431  0.03502267 -0.01954285
Function Value
[1] 160.4576
Gradient:
[1]  1.750618 -1.127049  5.378852 -0.949726 -2.984093  1.642584

iteration = 5
Step:
[1]  0.005396076 -0.001361519 -0.002086515 -0.016466432  0.031040204
[6] -0.017416912
Parameter:
[1] -0.25364364 -1.62607262 -2.24927244 -2.85011074  0.06606288 -0.03695976
Function Value
[1] 160.3789
Gradient:
[1]  2.832210 -1.055071  5.534809 -3.551852 -2.862058  1.525331

iteration = 6
Step:
[1]  0.0055637774 -0.0005837568 -0.0054607280 -0.0147538306  0.0439091427
[6] -0.0245147538
Parameter:
[1] -0.24807986 -1.62665638 -2.25473316 -2.86486457  0.10997202 -0.06147451
Function Value
[1] 160.2855
Gradient:
[1]  2.9381734 -0.5326318  2.6769171 -5.7760435 -2.6587451  1.3464188

iteration = 7
Step:
[1]  4.956084e-03  1.633592e-05 -7.396054e-03 -9.782643e-03  6.300947e-02
[6] -3.494043e-02
Parameter:
[1] -0.24312377 -1.62664004 -2.26212922 -2.87464721  0.17298149 -0.09641494
Function Value
[1] 160.16
Gradient:
[1]  2.3097416  0.1229979 -2.2081044 -7.0711472 -2.3337934  1.0764193

iteration = 8
Step:
[1]  0.0036978930  0.0006214356 -0.0078963399 -0.0021404240  0.1019481242
[6] -0.0561073123
Parameter:
[1] -0.2394259 -1.6260186 -2.2700256 -2.8767876  0.2749296 -0.1525223
Function Value
[1] 159.9654
Gradient:
[1]  1.1888692  0.5790484 -8.1401495 -6.9691096 -1.7712735  0.6319606

iteration = 9
Step:
[1] -0.0005184951  0.0017023873 -0.0032088739  0.0110806985  0.1373577081
[6] -0.0749122601
Parameter:
[1] -0.2399444 -1.6243162 -2.2732344 -2.8657069  0.4122873 -0.2274345
Function Value
[1] 159.7188
Gradient:
[1]   0.12604657   0.31888251 -11.69124182  -4.68673524  -0.98120793
[6]   0.04149879

iteration = 10
Step:
[1] -0.006383093  0.003022934  0.006457526  0.020385138  0.110421583
[6] -0.059260649
Parameter:
[1] -0.2463275 -1.6212933 -2.2667769 -2.8453218  0.5227089 -0.2866952
Function Value
[1] 159.5302
Gradient:
[1] -0.06138084 -0.61512962 -8.93740955 -1.16335078 -0.33753904 -0.42035223

iteration = 11
Step:
[1] -0.007029559  0.003179729  0.009872931  0.012416162  0.029757900
[6] -0.014767521
Parameter:
[1] -0.2533570 -1.6181136 -2.2569040 -2.8329056  0.5524668 -0.3014627
Function Value
[1] 159.4630
Gradient:
[1]  0.3673707 -1.1798763 -3.1384437  0.6811655 -0.1727532 -0.5463658

iteration = 12
Step:
[1] -0.003255687  0.002310265  0.004853699  0.001328920 -0.007720231
[6]  0.005477554
Parameter:
[1] -0.2566127 -1.6158033 -2.2520503 -2.8315767  0.5447466 -0.2959851
Function Value
[1] 159.4505
Gradient:
[1]  0.5064569 -0.9888117 -0.1759879  0.6457553 -0.2317629 -0.5152136

iteration = 13
Step:
[1] -0.001274212  0.001781446  0.001458004 -0.001273969 -0.005209899
[6]  0.004083137
Parameter:
[1] -0.2578869 -1.6140218 -2.2505923 -2.8328507  0.5395367 -0.2919020
Function Value
[1] 159.4475
Gradient:
[1]  0.3656227 -0.5398797  0.5462798  0.2773534 -0.2750449 -0.4898741

iteration = 14
Step:
[1] -7.583079e-04  1.580657e-03  3.563316e-04 -1.182417e-03 -1.185057e-05
[6]  1.653075e-03
Parameter:
[1] -0.2586452 -1.6124412 -2.2502359 -2.8340331  0.5395248 -0.2902489
Function Value
[1] 159.4461
Gradient:
[1]  0.10673409 -0.06446841  0.48149171 -0.02112311 -0.28700045 -0.48294615

iteration = 15
Step:
[1] -0.0004307630  0.0010904437 -0.0001045014 -0.0005872420  0.0028907106
[6]  0.0005514484
Parameter:
[1] -0.2590760 -1.6113507 -2.2503404 -2.8346203  0.5424155 -0.2896975
Function Value
[1] 159.4451
Gradient:
[1] -0.1373369  0.2784494  0.1515946 -0.1712186 -0.2796835 -0.4861220

iteration = 16
Step:
[1] -0.0003824129  0.0010505933 -0.0002693943 -0.0003567470  0.0050968917
[6]  0.0013407231
Parameter:
[1] -0.2594584 -1.6103002 -2.2506098 -2.8349771  0.5475124 -0.2883567
Function Value
[1] 159.4438
Gradient:
[1] -0.4079698  0.6088531 -0.3110657 -0.2709621 -0.2628988 -0.4912701

iteration = 17
Step:
[1] -0.0005096776  0.0014755696 -0.0004711411 -0.0003184091  0.0103738730
[6]  0.0052134159
Parameter:
[1] -0.2599681 -1.6088246 -2.2510810 -2.8352955  0.5578863 -0.2831433
Function Value
[1] 159.4406
Gradient:
[1] -0.8046272  1.0630586 -1.0428654 -0.3734032 -0.2306350 -0.4939632

iteration = 18
Step:
[1] -0.0006628261  0.0020718809 -0.0006996735 -0.0002798600  0.0210199492
[6]  0.0163318801
Parameter:
[1] -0.2606309 -1.6067527 -2.2517807 -2.8355754  0.5789062 -0.2668115
Function Value
[1] 159.4332
Gradient:
[1] -1.3560944  1.6741946 -2.1035109 -0.4829052 -0.1732649 -0.4808571

iteration = 19
Step:
[1] -0.0006455214  0.0024155946 -0.0008042064 -0.0001185403  0.0396761818
[6]  0.0416895063
Parameter:
[1] -0.2612764 -1.6043371 -2.2525849 -2.8356939  0.6185824 -0.2251219
Function Value
[1] 159.4174
Gradient:
[1] -1.95940108  2.32257136 -3.32591819 -0.56710801 -0.08254227 -0.42104607

iteration = 20
Step:
[1] -2.236849e-05  1.261784e-03 -3.378738e-04  3.285465e-04  5.849373e-02
[6]  7.836891e-02
Parameter:
[1] -0.2612988 -1.6030753 -2.2529227 -2.8353654  0.6770762 -0.1467530
Function Value
[1] 159.3924
Gradient:
[1] -2.16817425  2.49903594 -3.88381101 -0.52852715  0.01907855 -0.27692586

iteration = 21
Step:
[1]  0.0011700522 -0.0018841499  0.0008438540  0.0008490407  0.0488890933
[6]  0.0852947924
Parameter:
[1] -0.26012875 -1.60495947 -2.25207888 -2.83451631  0.72596525 -0.06145824
Function Value
[1] 159.3697
Gradient:
[1] -1.47105062  1.63274447 -2.72659493 -0.30111326  0.06231373 -0.08721321

iteration = 22
Step:
[1]  0.0013983432 -0.0032172177  0.0013010423  0.0006830582  0.0081189109
[6]  0.0314823725
Parameter:
[1] -0.25873041 -1.60817669 -2.25077783 -2.83383325  0.73408416 -0.02997587
Function Value
[1] 159.3616
Gradient:
[1] -0.463017187  0.476002848 -0.876650791 -0.070705985  0.036722079
[6]  0.005667556

iteration = 23
Step:
[1]  0.0005212158 -0.0013820624  0.0005392827  0.0001468612 -0.0093071329
[6] -0.0054113611
Parameter:
[1] -0.25820919 -1.60955875 -2.25023855 -2.83368639  0.72477703 -0.03538723
Function Value
[1] 159.3606
Gradient:
[1] -4.603263e-02  3.648231e-02 -9.140721e-02  4.725607e-05  9.710189e-03
[6]  7.133244e-03

iteration = 24
Parameter:
[1] -0.2581582 -1.6097375 -2.2501759 -2.8337041  0.7206572 -0.0397725
Function Value
[1] 159.3605
Gradient:
[1]  0.0035272762 -0.0068514568  0.0056561640  0.0016355443  0.0011000765
[6]  0.0007889867

Relative gradient close to zero.
Current iterate is probably solution.


 Estimation took  3.03  seconds.
Warning message: 
NA/Inf replaced by maximum positive value 
> 
> bbloc.moc2 <-  moc(bbloc[,c(2,4)],density=binom,group=2,gmu=gmu3[-3],gextra=gext3[-3],
+ expected=bin.fitted[-3],pgmu=c(-0.25,-1.61,-2.25),pgmix=0)
iteration = 0
Step:
[1] 0 0 0 0
Parameter:
[1] -0.25 -1.61 -2.25  0.00
Function Value
[1] 194.863
Gradient:
[1]  78.830303   6.134638 161.291411  -5.128317

iteration = 1
Step:
[1] -0.085438136 -0.006648865 -0.174811424  0.005558191
Parameter:
[1] -0.335438136 -1.616648865 -2.424811424  0.005558191
Function Value
[1] 185.8450
Gradient:
[1] -52.165633  12.041516 -59.485043  -3.269980

iteration = 2
Step:
[1]  0.034869104 -0.005920917  0.046006275  0.001305056
Parameter:
[1] -0.300569032 -1.622569781 -2.378805150  0.006863247
Function Value
[1] 183.2418
Gradient:
[1] -12.7944001  10.9605927  -0.3459167  -3.6649075

iteration = 3
Step:
[1]  0.011536005 -0.009466508  0.001159100  0.003150469
Parameter:
[1] -0.28903303 -1.63203629 -2.37764605  0.01001372
Function Value
[1] 183.0317
Gradient:
[1] -6.275364  8.460925  6.346516 -3.657943

iteration = 4
Step:
[1]  0.024083424 -0.024984968 -0.009393857  0.009898497
Parameter:
[1] -0.26494960 -1.65702126 -2.38703991  0.01991221
Function Value
[1] 182.7385
Gradient:
[1]  1.794796  2.077894  9.013404 -3.512722

iteration = 5
Step:
[1]  0.009547232 -0.012051508 -0.010084844  0.007264125
Parameter:
[1] -0.25540237 -1.66907276 -2.39712475  0.02717634
Function Value
[1] 182.6598
Gradient:
[1]  1.9353732 -0.9183652  3.7971384 -3.3878779

iteration = 6
Step:
[1]  0.001743179 -0.002463612 -0.004811175  0.005089051
Parameter:
[1] -0.25365919 -1.67153638 -2.40193593  0.03226539
Function Value
[1] 182.6391
Gradient:
[1]  0.6354874 -1.3805426 -0.1494582 -3.3296877

iteration = 7
Step:
[1]  0.0005909784 -0.0002200911 -0.0030298606  0.0073180158
Parameter:
[1] -0.25306821 -1.67175647 -2.40496579  0.03958340
Function Value
[1] 182.62
Gradient:
[1] -0.3283859 -1.1976672 -2.9700948 -3.2812593

iteration = 8
Step:
[1]  0.0011577163  0.0009138052 -0.0052127576  0.0245577194
Parameter:
[1] -0.25191050 -1.67084266 -2.41017854  0.06414112
Function Value
[1] 182.5675
Gradient:
[1] -1.7499942 -0.3767052 -7.9142409 -3.1530267

iteration = 9
Step:
[1]  0.001876485  0.002755840 -0.006354805  0.058740583
Parameter:
[1] -0.2500340 -1.6680868 -2.4165333  0.1228817
Function Value
[1] 182.4568
Gradient:
[1]  -3.073732   1.219601 -14.004991  -2.876976

iteration = 10
Step:
[1]  0.002640353  0.005873628 -0.006432371  0.135279754
Parameter:
[1] -0.2473937 -1.6622132 -2.4229657  0.2581615
Function Value
[1] 182.2251
Gradient:
[1]  -3.898949   3.774642 -20.515088  -2.271180

iteration = 11
Step:
[1]  0.0016873319  0.0082179622 -0.0007225752  0.2296137028
Parameter:
[1] -0.2457063 -1.6539952 -2.4236883  0.4877752
Function Value
[1] 181.8662
Gradient:
[1]  -3.405554   5.931462 -22.688249  -1.294162

iteration = 12
Step:
[1] -0.001880411  0.006463946  0.010384738  0.253136778
Parameter:
[1] -0.2475867 -1.6475313 -2.4133036  0.7409119
Function Value
[1] 181.5043
Gradient:
[1]  -1.6970390   5.0864716 -15.8790166  -0.3249317

iteration = 13
Step:
[1] -0.004576031  0.001316279  0.014459299  0.125414408
Parameter:
[1] -0.2521628 -1.6462150 -2.3988443  0.8663264
Function Value
[1] 181.3485
Gradient:
[1] -0.00751746  2.07637635 -4.79657178  0.08391015

iteration = 14
Step:
[1] -0.002321975 -0.001299761  0.005176271 -0.003157914
Parameter:
[1] -0.2544847 -1.6475148 -2.3936680  0.8631684
Function Value
[1] 181.3324
Gradient:
[1]  0.41170683  0.67591229 -0.43643830  0.06200465

iteration = 15
Step:
[1] -0.0005879493 -0.0011122907  0.0006018788 -0.0161563907
Parameter:
[1] -0.2550727 -1.6486271 -2.3930661  0.8470120
Function Value
[1] 181.3310
Gradient:
[1] 0.30258055 0.25972261 0.20732394 0.01039733

iteration = 16
Step:
[1] -0.0001650150 -0.0005938558 -0.0001412544 -0.0065060287
Parameter:
[1] -0.2552377 -1.6492209 -2.3932074  0.8405060
Function Value
[1] 181.3308
Gradient:
[1]  0.13976222  0.09245815  0.13697039 -0.00668210

iteration = 17
Step:
[1] -0.0000573211 -0.0001896064 -0.0001017364 -0.0003301361
Parameter:
[1] -0.2552950 -1.6494105 -2.3933091  0.8401759
Function Value
[1] 181.3308
Gradient:
[1]  0.047637954  0.029360769  0.042946202 -0.004870429

iteration = 18
Parameter:
[1] -0.2553268 -1.6494681 -2.3933428  0.8409081
Function Value
[1] 181.3308
Gradient:
[1]  0.0023329022  0.0012439955 -0.0006463534 -0.0009389140

Relative gradient close to zero.
Current iterate is probably solution.


 Estimation took  1.18  seconds.
Warning messages: 
1: NA/Inf replaced by maximum positive value 
2: NA/Inf replaced by maximum positive value 
> 
> bbloc.moc1 <-  moc(bbloc[,c(2,4)],density=binom,group=1,gmu=gmu3[-(2:3)],gextra=gext3[-(2:3)],
+ expected=bin.fitted[-(2:3)],pgmu=c(-0.25,-2.25))
iteration = 0
Step:
[1] 0 0
Parameter:
[1] -0.25 -2.25
Function Value
[1] 263.596
Gradient:
[1] -33.96108 -79.85007

iteration = 1
Step:
[1] 0.01707449 0.04014593
Parameter:
[1] -0.2329255 -2.2098541
Function Value
[1] 261.7196
Gradient:
[1]  8.951510 -2.272637

iteration = 2
Step:
[1] -0.004181943  0.001519162
Parameter:
[1] -0.2371075 -2.2083349
Function Value
[1] 261.6825
Gradient:
[1]  6.908297 -2.982005

iteration = 3
Step:
[1] -0.02011697  0.01083080
Parameter:
[1] -0.2572244 -2.1975041
Function Value
[1] 261.5957
Gradient:
[1] -0.1815136 -0.5149749

iteration = 4
Step:
[1] -0.0001478704  0.0003557768
Parameter:
[1] -0.2573723 -2.1971483
Function Value
[1] 261.5956
Gradient:
[1] -0.02338661 -0.04150883

iteration = 5
Parameter:
[1] -0.2573623 -2.1971278
Function Value
[1] 261.5956
Gradient:
[1] -1.642661e-04 -6.409712e-05

Relative gradient close to zero.
Current iterate is probably solution.


 Estimation took  0.2  seconds.
Warning messages: 
1: NA/Inf replaced by maximum positive value 
2: NA/Inf replaced by maximum positive value 
> 
> bbloc.moc1

		 1 mixtures MOC model


Response:  as.matrix(bbloc[, c(2, 4)]) 

Density: binom 
function (x, prob, sh = 1, size) 
{
    dbinom(x, size, prob)
}

Location: gmu3[-(2:3)] 
Group1 :
function (p) 
{
    matrix({
        cbind(1/(1 + exp(-p[2])), 1/(1 + exp(-p[2] - p[1])))
    }, 22, 2, byrow = TRUE)
}


Expectation: bin.fitted[-(2:3)] 
Group1 :
function (p) 
(gmu3[[1]](p) %x% rep(1, 22)) * gext3[[1]](p)


Extra parameter: gext3[-(2:3)] 
Group1 :
function (p) 
cbind(bbloc[, 3], bbloc[, 5])


Mixture: inv.glogit
function (gmix) 
{
    matrix({
        cbind(1)
    }, 22, 1, byrow = TRUE)
}


			Maximum Likelihood Estimates

                                 Standard  Wald Chi-Sq: 
Parameter          Estimate         Error     Param = 0   Prob > Wald 

Location:

                   -0.25736      0.049414        27.126    1.9064e-07
                   -2.19713      0.033580      4280.950    0.0000e+00 

  -2*logLikelihood      AIC -2*logLik      BIC Entropy  ICL-BIC Df
          523.1913 527.1913  523.1913 530.7596       0 530.7596 42


Posterior mean predicted values:
        Death Death.1
Group1 44.772  37.545

Posterior mean observed values:
        Death Death.1
Group1 44.773  37.545

> bbloc.moc2

		 2 mixtures MOC model


Response:  as.matrix(bbloc[, c(2, 4)]) 

Density: binom 
function (x, prob, sh = 1, size) 
{
    dbinom(x, size, prob)
}

Location: gmu3[-3] 
Group1 :
function (p) 
{
    matrix({
        cbind(1/(1 + exp(-p[2])), 1/(1 + exp(-p[2] - p[1])))
    }, 22, 2, byrow = TRUE)
}

Group2 :
function (p) 
{
    matrix({
        cbind(1/(1 + exp(-p[3])), 1/(1 + exp(-p[3] - p[1])))
    }, 22, 2, byrow = TRUE)
}


Expectation: bin.fitted[-3] 
Group1 :
function (p) 
(gmu3[[1]](p) %x% rep(1, 22)) * gext3[[1]](p)

Group2 :
function (p) 
(gmu3[[2]](p) %x% rep(1, 22)) * gext3[[2]](p)


Extra parameter: gext3[-3] 
Group1 :
function (p) 
cbind(bbloc[, 3], bbloc[, 5])

Group2 :
function (p) 
cbind(bbloc[, 3], bbloc[, 5])


Mixture: inv.glogit
function (gmix) 
{
    matrix({
        rbind(c(1, exp(gmix)))/(1 + sum(exp(gmix)))
    }, 22, 2, byrow = TRUE)
}
attr(,"parameters")
[1] "  G2 vs G1"


			Maximum Likelihood Estimates

                                 Standard  Wald Chi-Sq: 
Parameter          Estimate         Error     Param = 0   Prob > Wald 

Location:

                   -0.25533      0.049986        26.091    3.2568e-07
                   -1.64947      0.058276       801.142    0.0000e+00
                   -2.39334      0.040054      3570.454    0.0000e+00 

Mixture:

  G2 vs G1           0.8409       0.53309        2.4882        0.1147 

Mean Mixture Probabilities:
 Group1  Group2 
0.30134 0.69866 

  -2*logLikelihood      AIC -2*logLik      BIC  Entropy  ICL-BIC Df
          362.6616 370.6616  362.6616 377.7984 2.398589 382.5956 40


Mean Posterior Mixture Probabilities:
Group1 Group2 
0.3013 0.6987 


Posterior mean predicted values:
        Death Death.1
Group1 50.454  41.913
Group2 42.322  35.662

Posterior mean observed values:
        Death Death.1
Group1 51.806  40.561
Group2 41.740  36.245

> bbloc.moc3

		 3 mixtures MOC model


Response:  as.matrix(bbloc[, c(2, 4)]) 

Density: binom 
function (x, prob, sh = 1, size) 
{
    dbinom(x, size, prob)
}

Location: gmu3 
Group1 :
function (p) 
{
    matrix({
        cbind(1/(1 + exp(-p[2])), 1/(1 + exp(-p[2] - p[1])))
    }, 22, 2, byrow = TRUE)
}

Group2 :
function (p) 
{
    matrix({
        cbind(1/(1 + exp(-p[3])), 1/(1 + exp(-p[3] - p[1])))
    }, 22, 2, byrow = TRUE)
}

Group3 :
function (p) 
{
    matrix({
        cbind(1/(1 + exp(-p[4])), 1/(1 + exp(-p[4] - p[1])))
    }, 22, 2, byrow = TRUE)
}


Expectation: bin.fitted 
Group1 :
function (p) 
(gmu3[[1]](p) %x% rep(1, 22)) * gext3[[1]](p)

Group2 :
function (p) 
(gmu3[[2]](p) %x% rep(1, 22)) * gext3[[2]](p)

Group3 :
function (p) 
(gmu3[[3]](p) %x% rep(1, 22)) * gext3[[3]](p)


Extra parameter: gext3 
Group1 :
function (p) 
cbind(bbloc[, 3], bbloc[, 5])

Group2 :
function (p) 
cbind(bbloc[, 3], bbloc[, 5])

Group3 :
function (p) 
cbind(bbloc[, 3], bbloc[, 5])


Mixture: inv.glogit
function (gmix) 
{
    matrix({
        rbind(c(1, exp(gmix)))/(1 + sum(exp(gmix)))
    }, 22, 3, byrow = TRUE)
}
attr(,"parameters")
[1] "  G2 vs G1" "  G3 vs G1"


			Maximum Likelihood Estimates

                                 Standard  Wald Chi-Sq: 
Parameter          Estimate         Error     Param = 0   Prob > Wald 

Location:

                   -0.25816      0.049892        26.774    2.2873e-07
                   -1.60974      0.055710       834.920    0.0000e+00
                   -2.25018      0.040516      3084.533    0.0000e+00
                   -2.83370      0.075067      1424.998    0.0000e+00 

Mixture:

  G2 vs G1         0.720657       0.56331     1.6367022       0.20078
  G3 vs G1        -0.039773       0.63758     0.0038913       0.95026 

Mean Mixture Probabilities:
 Group1  Group2  Group3 
0.24895 0.51180 0.23925 

  -2*logLikelihood      AIC -2*logLik      BIC  Entropy  ICL-BIC Df
          318.7210 330.7210  318.7210 341.4262 2.805154 347.0365 38


Mean Posterior Mixture Probabilities:
 Group1  Group2  Group3 
0.24904 0.51175 0.23921 


Posterior mean predicted values:
        Death Death.1
Group1 56.071  45.425
Group2 49.620  42.921
Group3 22.639  17.842

Posterior mean observed values:
        Death Death.1
Group1 57.488  44.010
Group2 49.719  42.823
Group3 20.955  19.526

> 
> # Adding a random slope
> 
> gmu3.rs <-list(
+  Group1 = function (p) {cbind(1/(1 + exp(-p[1])), 1/(1 + exp(-p[1] - p[2])))},
+  Group2 = function (p) {cbind(1/(1 + exp(-p[3])), 1/(1 + exp(-p[3] - p[4])))},
+  Group3 = function (p) {cbind(1/(1 + exp(-p[5])), 1/(1 + exp(-p[5] - p[6])))})
>    
> bin.fitted.rs <- list(
+  Group1 = function(p) (gmu3.rs[[1]](p)%x%rep(1,22))*gext3[[1]](p),
+  Group2 = function(p) (gmu3.rs[[2]](p)%x%rep(1,22))*gext3[[2]](p),
+  Group3 = function(p) (gmu3.rs[[3]](p)%x%rep(1,22))*gext3[[3]](p))
> 
> bbloc.moc3.rs <-  moc(bbloc[,c(2,4)],density=binom,group=3,gmu=gmu3.rs,gextra=gext3,
+ expected=bin.fitted.rs,pgmu=c(-1.58,-0.32,-2.25,-0.25,-2.9,-0.08),pgmix=bbloc.moc3$coef[5:6])
iteration = 0
Step:
[1] 0 0 0 0 0 0 0 0
Parameter:
[1] -1.5800000 -0.3200000 -2.2500000 -0.2500000 -2.9000000 -0.0800000  0.7206572
[8] -0.0397725
Function Value
[1] 158.3644
Gradient:
[1]  0.600457823  0.846403540  3.362117393  4.610733282  3.256463836
[6]  1.608143825  0.005646447 -0.023219772

iteration = 1
Step:
[1] -7.772386e-04 -1.095593e-03 -4.351959e-03 -5.968179e-03 -4.215199e-03
[6] -2.081598e-03 -7.308818e-06  3.005591e-05
Parameter:
[1] -1.58077724 -0.32109559 -2.25435196 -0.25596818 -2.90421520 -0.08208160
[7]  0.72064994 -0.03974245
Function Value
[1] 158.3342
Gradient:
[1]  0.45027422  0.64382956 -3.11174027  0.17877529  2.22763883  1.00656777
[7]  0.02341749 -0.01330762

iteration = 2
Step:
[1] -8.556587e-04 -1.217970e-03  2.516169e-03 -2.317058e-03 -4.362455e-03
[6] -2.033013e-03 -3.293141e-05  2.776390e-05
Parameter:
[1] -1.58163290 -0.32231356 -2.25183579 -0.25828524 -2.90857765 -0.08411461
[7]  0.72061701 -0.03971468
Function Value
[1] 158.3181
Gradient:
[1] -0.15494872  0.23040772 -1.74212120  0.28156180  1.17913547  0.39202642
[7]  0.02341187 -0.00880128

iteration = 3
Step:
[1]  6.854287e-05 -1.129386e-03  3.233111e-03 -3.221532e-03 -5.123706e-03
[6] -2.003161e-03 -6.881908e-05  3.739716e-05
Parameter:
[1] -1.58156435 -0.32344295 -2.24860268 -0.26150677 -2.91370136 -0.08611777
[7]  0.72054819 -0.03967729
Function Value
[1] 158.3109
Gradient:
[1] -0.395817471 -0.011455222 -0.147338802  0.275667841 -0.011928336
[6] -0.289584776  0.017250923 -0.003931316

iteration = 4
Step:
[1]  5.133239e-04 -6.679036e-05  4.018546e-04 -5.710754e-04 -3.154010e-04
[6]  2.550625e-04 -2.714977e-05  7.658700e-06
Parameter:
[1] -1.58105103 -0.32350974 -2.24820082 -0.26207785 -2.91401676 -0.08586271
[7]  0.72052104 -0.03966963
Function Value
[1] 158.3105
Gradient:
[1] -0.211943426  0.061979298 -0.047315305  0.188264417 -0.049735995
[6] -0.295416370  0.014320281 -0.003854257

iteration = 5
Step:
[1]  9.394047e-04 -3.007933e-04  6.011248e-04 -9.873210e-04 -2.178506e-04
[6]  1.019915e-03 -6.414978e-05  1.821510e-05
Parameter:
[1] -1.58011163 -0.32381053 -2.24759970 -0.26306517 -2.91423461 -0.08484279
[7]  0.72045689 -0.03965141
Function Value
[1] 158.3101
Gradient:
[1]  0.098896736  0.164300647  0.041644898 -0.001910249  0.003376301
[6] -0.218866271  0.010100487 -0.004185193

iteration = 6
Step:
[1]  2.081215e-04 -3.251046e-04  1.607864e-04 -3.074707e-04 -5.433188e-05
[6]  6.898598e-04 -3.748456e-05  1.233301e-05
Parameter:
[1] -1.57990350 -0.32413564 -2.24743891 -0.26337264 -2.91428894 -0.08415293
[7]  0.72041941 -0.03963908
Function Value
[1] 158.3099
Gradient:
[1]  0.123842234  0.137327891  0.053711755 -0.067989905  0.057798258
[6] -0.157912865  0.009892912 -0.004366288

iteration = 7
Step:
[1]  1.087675e-04 -6.559996e-04  1.118914e-04 -2.524701e-04 -2.177673e-04
[6]  1.234280e-03 -7.270742e-05  2.584357e-05
Parameter:
[1] -1.57979474 -0.32479164 -2.24732702 -0.26362511 -2.91450671 -0.08291865
[7]  0.72034670 -0.03961324
Function Value
[1] 158.3097
Gradient:
[1]  0.053525912  0.029638059  0.055550619 -0.125496729  0.131981069
[6] -0.059935942  0.010865281 -0.004447588

iteration = 8
Step:
[1] -2.068162e-05 -3.500353e-04 -5.738986e-05  7.929540e-05 -3.093812e-04
[6]  6.926569e-04 -5.271424e-05  1.960320e-05
Parameter:
[1] -1.57981542 -0.32514167 -2.24738441 -0.26354581 -2.91481609 -0.08222600
[7]  0.72029398 -0.03959363
Function Value
[1] 158.3097
Gradient:
[1] -0.014385149 -0.041079639  0.044528744 -0.111850125  0.137276509
[6] -0.022483781  0.011489024 -0.004210719

iteration = 9
Step:
[1] -5.176049e-07 -3.102133e-04 -1.682379e-04  2.896276e-04 -6.068658e-04
[6]  8.266162e-04 -8.212685e-05  3.039108e-05
Parameter:
[1] -1.57981594 -0.32545189 -2.24755265 -0.26325618 -2.91542296 -0.08139938
[7]  0.72021186 -0.03956324
Function Value
[1] 158.3096
Gradient:
[1] -0.0672298608 -0.1001967860  0.0201461370 -0.0556380314  0.0973414796
[6] -0.0001729319  0.0114596162 -0.0035954457

iteration = 10
Step:
[1]  6.456068e-05 -3.024417e-05 -1.448202e-04  2.685266e-04 -5.259572e-04
[6]  4.764655e-04 -6.732272e-05  2.406783e-05
Parameter:
[1] -1.57975138 -0.32548213 -2.24769747 -0.26298766 -2.91594892 -0.08092291
[7]  0.72014454 -0.03953917
Function Value
[1] 158.3095
Gradient:
[1] -0.0466451022 -0.0941916142 -0.0003269733 -0.0028624640  0.0399806506
[6] -0.0039630351  0.0104402204 -0.0029939997

iteration = 11
Step:
[1]  6.347043e-05  1.414212e-04 -5.734387e-05  1.164977e-04 -2.729662e-04
[6]  1.613811e-04 -4.210128e-05  1.399288e-05
Parameter:
[1] -1.57968790 -0.32534071 -2.24775481 -0.26287116 -2.91622188 -0.08076153
[7]  0.72010243 -0.03952518
Function Value
[1] 158.3095
Gradient:
[1]  0.002819222 -0.055625600 -0.008959457  0.020019817  0.002026191
[6] -0.014240618  0.009314803 -0.002638942

iteration = 12
Step:
[1]  5.398407e-06  1.425735e-04  4.123449e-06 -1.217745e-06 -7.346939e-05
[6]  3.891628e-05 -2.550117e-05  7.671748e-06
Parameter:
[1] -1.57968251 -0.32519814 -2.24775069 -0.26287238 -2.91629535 -0.08072262
[7]  0.72007693 -0.03951751
Function Value
[1] 158.3095
Gradient:
[1]  0.029701386 -0.027131790 -0.008870030  0.019773813 -0.008661757
[6] -0.017477382  0.008760557 -0.002503535

iteration = 13
Step:
[1] -4.710482e-05  1.755952e-04  2.274904e-05 -3.856654e-05 -4.784376e-05
[6]  7.059107e-05 -3.955646e-05  1.161231e-05
Parameter:
[1] -1.57972961 -0.32502254 -2.24772794 -0.26291094 -2.91634319 -0.08065203
[7]  0.72003738 -0.03950590
Function Value
[1] 158.3095
Gradient:
[1]  0.041938094 -0.001379541 -0.005910649  0.012369404 -0.011376137
[6] -0.015262731  0.008381571 -0.002360838

iteration = 14
Step:
[1] -9.847841e-05  1.587599e-04  2.669366e-05 -5.074824e-05 -3.707026e-05
[6]  1.174285e-04 -5.352841e-05  1.559904e-05
Parameter:
[1] -1.5798281 -0.3248638 -2.2477012 -0.2629617 -2.9163803 -0.0805346  0.7199838
[8] -0.0394903
Function Value
[1] 158.3095
Gradient:
[1]  0.031370689  0.012250689 -0.001804289  0.002852093 -0.007555054
[6] -0.007522416  0.008273571 -0.002195569

iteration = 15
Parameter:
[1] -1.57990648 -0.32481254 -2.24769072 -0.26298537 -2.91639526 -0.08044759
[7]  0.71994412 -0.03947902
Function Value
[1] 158.3095
Gradient:
[1]  0.0099670275  0.0086264066  0.0003428980 -0.0013622241 -0.0022724199
[6] -0.0005898556  0.0083856747 -0.0020791163

Relative gradient close to zero.
Current iterate is probably solution.


 Estimation took  2.61  seconds.
> 
> bbloc.moc3.rs

		 3 mixtures MOC model


Response:  as.matrix(bbloc[, c(2, 4)]) 

Density: binom 
function (x, prob, sh = 1, size) 
{
    dbinom(x, size, prob)
}

Location: gmu3.rs 
Group1 :
function (p) 
{
    matrix({
        cbind(1/(1 + exp(-p[1])), 1/(1 + exp(-p[1] - p[2])))
    }, 22, 2, byrow = TRUE)
}

Group2 :
function (p) 
{
    matrix({
        cbind(1/(1 + exp(-p[3])), 1/(1 + exp(-p[3] - p[4])))
    }, 22, 2, byrow = TRUE)
}

Group3 :
function (p) 
{
    matrix({
        cbind(1/(1 + exp(-p[5])), 1/(1 + exp(-p[5] - p[6])))
    }, 22, 2, byrow = TRUE)
}


Expectation: bin.fitted.rs 
Group1 :
function (p) 
(gmu3.rs[[1]](p) %x% rep(1, 22)) * gext3[[1]](p)

Group2 :
function (p) 
(gmu3.rs[[2]](p) %x% rep(1, 22)) * gext3[[2]](p)

Group3 :
function (p) 
(gmu3.rs[[3]](p) %x% rep(1, 22)) * gext3[[3]](p)


Extra parameter: gext3 
Group1 :
function (p) 
cbind(bbloc[, 3], bbloc[, 5])

Group2 :
function (p) 
cbind(bbloc[, 3], bbloc[, 5])

Group3 :
function (p) 
cbind(bbloc[, 3], bbloc[, 5])


Mixture: inv.glogit
function (gmix) 
{
    matrix({
        rbind(c(1, exp(gmix)))/(1 + sum(exp(gmix)))
    }, 22, 3, byrow = TRUE)
}
attr(,"parameters")
[1] "  G2 vs G1" "  G3 vs G1"


			Maximum Likelihood Estimates

                                 Standard  Wald Chi-Sq: 
Parameter          Estimate         Error     Param = 0   Prob > Wald 

Location:

                  -1.579906      0.065958     573.74813    0.0000e+00
                  -0.324813      0.092878      12.23032    4.7019e-04
                  -2.247691      0.045163    2476.92537    0.0000e+00
                  -0.262985      0.065579      16.08189    6.0661e-05
                  -2.916395      0.099195     864.39592    0.0000e+00
                  -0.080448      0.141009       0.32548    5.6833e-01 

Mixture:

  G2 vs G1         0.719944       0.56386     1.6302689       0.20167
  G3 vs G1        -0.039479       0.63680     0.0038435       0.95057 

Mean Mixture Probabilities:
 Group1  Group2  Group3 
0.24903 0.51158 0.23939 

  -2*logLikelihood     AIC -2*logLik      BIC  Entropy  ICL-BIC Df
           316.619 332.619   316.619 346.8925 2.735784 352.3641 36


Mean Posterior Mixture Probabilities:
 Group1  Group2  Group3 
0.24931 0.51120 0.23948 


Posterior mean predicted values:
        Death Death.1
Group1 57.474  43.969
Group2 49.742  42.847
Group3 20.941  19.542

Posterior mean observed values:
        Death Death.1
Group1 57.474  43.968
Group2 49.743  42.848
Group3 20.941  19.542

>    
> proc.time()
[1] 10.37  0.17 10.70  0.02  0.00
> 
